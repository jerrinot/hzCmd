#!/usr/bin/env bash

path=$1

cd ${path} || exit 1

files=$(find . -type f -name '*.csv' | xargs -n1 basename | sort | uniq)


while read -r f; do

 mkdir ${f}-charts

 chart-JavaMetrics ${f} ${f}
 mv *.png ${f}-charts

 meta=$(basename ${f})
 meta=${meta%.csv}".meta.txt"
 meta=$(find . -name ${meta} -print -quit)
 cp ${meta} ${f}-charts

done <<< "$files"